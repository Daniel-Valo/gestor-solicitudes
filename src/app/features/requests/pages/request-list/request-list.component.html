<div class="mx-auto px-10 py-10 bg-white rounded-lg">
  <header class="flex items-center justify-between mb-4">
    <!-- Título alineado a la izquierda -->
    <h2 class="text-4xl font-bold text-green-800">Solicitudes</h2>

    <!-- Botón alineado a la derecha -->
    <button
      class="p-2 border rounded-3xl hover:bg-gray-200"
      title="Cerrar sesión"
      (click)="logout()"
    >
      <!-- Icono -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="size-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"
        />
      </svg>
    </button>
  </header>
  <!-- SEPARADOR -->
  <div class="w-full bg-green-600 mt-1 mb-4" style="height: 1px"></div>
  <!-- Contenedor para boton agregar -->
  <div class="rounded-md py-2">
    <!-- Boton agregar -->
    <div class="flex flex-col my-3 justify-end sm:flex-row gap-3 sm:px-4">
      <!-- BOTÓN PARA AGREGAR UNA SOLICITUD NUEVA -->
      <button
        (click)="onModalAddEditRequestOpen()"
        title="Agregar una solicitud nueva"
        class="inline-flex items-center justify-center min-w-[240px] bg-green-600 hover:bg-green-700 text-white font-semibold px-5 py-2 rounded-md shadow-md transition-colors gap-x-2"
      >
        <!-- Icono -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 4v16m8-8H4"
          />
        </svg>
        <span class="text-sm sm:text-base">Nueva solicitud</span>
      </button>
    </div>
  </div>
  <!-- Filtros -->
  <div
    class="bg-[#f0efef] rounded-md px-4 py-6 mb-4 border border-gray-300 shadow-sm"
  >
    <!-- Encabezado panel filtros -->
    <h3 class="text-lg font-semibold mb-4 text-gray-800">Filtros</h3>
    <div class="grid grid-cols-2 md:grid-cols-8 gap-4">
      <!-- Búsqueda -->
      <input
        type="text"
        placeholder="Buscar por título o usuario"
        class="border rounded-md px-4 w-full focus:outline-none focus:ring-2 focus:ring-green-600 col-span-2 md:col-span-5"
        [value]="store.getSearchTerm()"
        (input)="store.setSearchTerm($any($event.target).value)"
      />
      <!-- Categoría -->
      <select
        class="border rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-600 col-span-2 md:col-span-1"
        [value]="store.getCategory()"
        (change)="store.setCategory($any($event.target).value)"
      >
        <option value="Todas">Todas las categorías</option>
        <option value="Permiso">Permiso</option>
        <option value="Compra">Compra</option>
        <option value="Soporte">Soporte</option>
      </select>

      <!-- Estado -->
      <select
        class="border rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-600 col-span-2 md:col-span-1"
        [value]="store.getStatus()"
        (change)="store.setStatus($any($event.target).value)"
      >
        <option value="Todos">Todos los estados</option>
        <option value="Pendiente">Pendiente</option>
        <option value="En Proceso">En Proceso</option>
        <option value="Finalizada">Finalizada</option>
      </select>

      <!-- Limpiar filtros -->
      <button
        class="inline-flex items-center justify-center bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors col-span-2 md:col-span-1 gap-x-2"
        (click)="resetFilters()"
      >
        <!-- Icono -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-5 h-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 18 18 6M6 6l12 12"
          />
        </svg>

        <span class="text-sm sm:text-base">Limpiar filtros</span>
      </button>
    </div>
  </div>

  <!-- Contenedor tabla de solicitudes responsive -->
  <div class="w-full overflow-x-auto">
    <!-- tabla de solicitudes -->
    <table class="min-w-full table-fixed bg-white rounded">
      <thead>
        <tr
          class="text-md font-semibold tracking-wide text-left text-gray-600 bg-[#f0efef] uppercase border border-gray-300 rounded"
        >
          <th class="px-4 py-2 text-left">Título</th>
          <th class="px-4 py-2 text-left">Categoría</th>
          <th class="px-4 py-2 text-left">Estatus</th>
          <th class="px-4 py-2 text-left">Fecha</th>
          <th class="px-4 py-2 text-left">Usuario</th>
          <th class="px-4 py-2 text-center whitespace-nowrap">Acciones</th>
        </tr>
      </thead>
      <tbody class="text-sm font-normal text-gray-700">
        <tr
          class="hover:bg-gray-50 border even:bg-gray-50 odd:bg-white"
          *ngFor="let r of store.applyFilters()"
        >
          <td class="px-4 py-2">{{ r.title }}</td>
          <td class="px-4 py-2">
            <span
              [ngClass]="{
                'bg-rose-600': r.category === 'Permiso',
                'bg-orange-600': r.category === 'Compra',
                'bg-cyan-600 ': r.category === 'Soporte'
              }"
              class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium text-gray-200 ring-1 ring-gray-500/10 ring-inset"
            >
              {{ r.category | titlecase }}
            </span>
          </td>
          <td class="px-4 py-2">
            <span
              [ngClass]="{
                'bg-blue-600 ': r.status === 'Pendiente',
                'bg-green-600 ': r.status === 'En Proceso',
                'bg-gray-600 ': r.status === 'Finalizada'
              }"
              class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium text-gray-200 ring-1 ring-gray-500/10 ring-inset"
            >
              {{ r.status | titlecase }}
            </span>
          </td>
          <td class="px-4 py-2">
            {{ r.createdAt | date : "dd/MM/yyyy" : "es-MX" }}
          </td>
          <td class="px-4 py-2">{{ r.user }}</td>
          <td class="p-2 text-center">
            <div class="flex justify-center items-center gap-2">
              <!-- Editar -->
              <button
                class="p-2 border rounded hover:bg-gray-200"
                title="Editar solicitud"
                (click)="onModalAddEditRequestOpen(r)"
              >
                <!-- Icono editar -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="w-5 h-5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"
                  />
                </svg>
              </button>
              <!-- Eliminar -->
              <button
                class="p-2 border rounded hover:bg-gray-200 text-red-500"
                title="Eliminar solicitud"
                (click)="onModalConfirmDeleteOpen(r)"
              >
                <!-- Icono eliminar -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-5 h-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7V4h6v3"
                  />
                </svg>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
      <!-- Dialogo para confirmar si elimina o no una solicitud -->
      <app-confirm-dialog
        *ngIf="showModalConfirmDelete"
        title="Eliminar solicitud"
        [message]="deleteConfirmationMessage"
        (onConfirmResultEvent)="onModalConfirmDeleteResultEventHandler($event)"
      />
      <!-- Dialogo para agregar o editar una solicitud -->
      <app-request-form
        *ngIf="showModalAddEditRequest"
        [request]="selectedRequest"
        (onSubmitEvent)="onConfirmModalAddEditEventHandler($event)"
        (onCancelEvent)="onCancelModalAddEditEventHandler()"
      />
    </table>
  </div>
  <!-- toast notification -->
  <div
    *ngIf="showToast"
    class="fixed top-4 right-4 z-50 px-4 py-3 rounded shadow-md text-white transition-opacity duration-300"
    [ngClass]="{
      'bg-green-600': toastType === 'success',
      'bg-red-600': toastType === 'error'
    }"
  >
    {{ toastMessage }}
  </div>
</div>
