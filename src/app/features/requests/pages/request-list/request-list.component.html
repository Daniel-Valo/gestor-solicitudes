<div class="mx-auto px-10 py-10 my-10 bg-white rounded-lg">
  <!-- Titulo -->
  <h2 class="text-4xl font-bold mb-4 text-green-800">Solicitudes</h2>
  <!-- SEPARADOR -->
  <div class="w-full bg-green-600 mt-1 mb-14" style="height: 1px"></div>
  <!-- Filtros -->
  <div class="flex flex-col justify-end sm:flex-row gap-2 mb-4">
    <!-- Filtro para categorias -->
    <select
      (change)="onCategoryChange($any($event.target).value)"
      class="p-2 border border-green-800 focus:outline-none rounded w-full sm:w-2/12"
    >
      <option value="Todas">Todas las categorías</option>
      <option>Permiso</option>
      <option>Compra</option>
      <option>Soporte</option>
    </select>
    <!-- Filtro para estatus -->
    <select
      (change)="onStatusChange($any($event.target).value)"
      class="p-2 border border-green-800 focus:outline-none rounded w-full sm:w-2/12"
    >
      <option value="Todos">Todos los estatus</option>
      <option>Pendiente</option>
      <option>En Proceso</option>
      <option>Finalizada</option>
    </select>
  </div>
  <!-- Busqueda de solicitudes y boton agregar -->
  <div class="flex flex-col justify-end sm:flex-row gap-2 mb-4">
    <!-- CAMPO PARA BUSQUEDA DE SOLICITUDES -->
    <input
      [ngModel]="searchTerm$ | async"
      (ngModelChange)="onTextSearchChange($event)"
      class="py-2 pl-10 border border-gray-400 w-full focus:border-green-700 focus:outline-none rounded"
      placeholder="Buscar solicitud"
      type="text"
    />
    <!-- BUTON PARA AGREGAR UNA SOLICITUD NUEVA -->
    <button
      (click)="add()"
      title="Agregar una solicitud nueva"
      class="bg-green-800 border border-green-900 hover:bg-green-700 hover:text-white duration-100 ease-in-out w-full sm:w-1/12 text-green-100 p-2 flex flex-row justify-center items-center gap-1"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="w-5 h-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 4v16m8-8H4"
        />
      </svg>
      <span class="sm:text-sm">Nueva</span>
    </button>
  </div>
  <!-- Tabla de solicitudes -->
  <div class="w-full overflow-x-auto">
    <table class="min-w-full table-fixed">
      <thead>
        <tr
          class="text-md font-semibold tracking-wide text-left text-gray-700 bg-green-100 uppercase border border-gray-300"
        >
          <th class="px-4 py-2 text-left">Título</th>
          <th class="px-4 py-2 text-left">Categoría</th>
          <th class="px-4 py-2 text-left">Estatus</th>
          <th class="px-4 py-2 text-left">Fecha</th>
          <th class="px-4 py-2 text-left">Usuario</th>
          <th class="px-4 py-2 text-center whitespace-nowrap">Acciones</th>
        </tr>
      </thead>
      <tbody class="text-sm font-normal text-gray-700">
        <tr
          class="hover:bg-gray-50 border"
          *ngFor="let r of filteredRequests$ | async"
        >
          <td class="px-4 py-2">{{ r.title }}</td>
          <td class="px-4 py-2">{{ r.category }}</td>
          <td class="px-4 py-2">{{ r.status }}</td>
          <td class="px-4 py-2">
            {{ r.createdAt | date : "dd/MM/yyyy hh:mm a" : "es-MX" }}
          </td>
          <td class="px-4 py-2">{{ r.user }}</td>
          <td class="p-2 text-center">
            <div class="flex justify-center items-center gap-2">
              <!-- Editar -->
              <button
                class="p-2 border rounded hover:bg-gray-200"
                title="Editar solicitud"
                [routerLink]="['/solicitudes/editar', r.id]"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  class="w-5 h-5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"
                  />
                </svg>
              </button>
              <!-- Eliminar -->
              <button
                class="p-2 border rounded hover:bg-gray-200 text-red-500"
                title="Eliminar solicitud"
                (click)="askDelete(r)"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="w-5 h-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M9 7V4h6v3"
                  />
                </svg>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
      <app-confirm-dialog
        *ngIf="showConfirm"
        (confirm)="onConfirmResult($event)"
        [message]="
          'Se eliminara la solicitud: ' +
          informationToDisplay +
          ', Este proceso ya no es reversible. ¿Desea continuar?'
        "
        title="Eliminar solicitud"
      ></app-confirm-dialog>
    </table>
  </div>
</div>
